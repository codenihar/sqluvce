CREATE TABLE DEPARTMENT
(
  DNo INT PRIMARY KEY,
  DName VARCHAR(100),
  MgrSSN VARCHAR(10),
  MgrStartDate DATE
);


CREATE TABLE EMPLOYEE
(
  SSN VARCHAR(10) PRIMARY KEY,
  Name VARCHAR(100),
  Address VARCHAR(200),
  Sex CHAR(1),
  Salary DECIMAL(10, 2),
  SuperSSN VARCHAR(10),
  DNo INT,
  FOREIGN KEY (DNo) REFERENCES DEPARTMENT(DNo)
);


CREATE TABLE DLOCATION
(
  DNo INT,
  DLoc VARCHAR(100),
  FOREIGN KEY (DNo) REFERENCES DEPARTMENT(DNo)
);


CREATE TABLE PROJECT
(
  PNo INT PRIMARY KEY,
  PName VARCHAR(100),
  PLocation VARCHAR(100),
  DNo INT,
  FOREIGN KEY (DNo) REFERENCES DEPARTMENT(DNo)
);


CREATE TABLE WORKS_ON
(
  SSN VARCHAR(10),
  PNo INT,
  Hours DECIMAL(5, 2),
  FOREIGN KEY (SSN) REFERENCES EMPLOYEE(SSN),
  FOREIGN KEY (PNo) REFERENCES PROJECT(PNo)
);
  SELECT DISTINCT P.PNo
  FROM PROJECT P
    JOIN WORKS_ON W ON P.PNo = W.PNo
    JOIN EMPLOYEE E ON W.SSN = E.SSN
  WHERE E.Name LIKE '%Scott%'
UNION
  SELECT DISTINCT P.PNo
  FROM PROJECT P
    JOIN DEPARTMENT D ON P.DNo = D.DNo
    JOIN EMPLOYEE E ON D.MgrSSN = E.SSN
  WHERE E.Name LIKE '%Scott%';
SELECT E.SSN, E.Name, (E.Salary * 1.10) AS NewSalary
FROM EMPLOYEE E
  JOIN WORKS_ON W ON E.SSN = W.SSN
  JOIN PROJECT P ON W.PNo = P.PNo
WHERE P.PName = 'IoT';
SELECT SUM(Salary) AS TotalSalary, MAX(Salary) AS MaxSalary,
  MIN(Salary) AS MinSalary, AVG(Salary) AS AvgSalary
FROM EMPLOYEE
WHERE DNo = (SELECT DNo
FROM DEPARTMENT
WHERE DName = 'Accounts');


SELECT E.Name
FROM EMPLOYEE E
WHERE NOT EXISTS (
  SELECT P.PNo
FROM PROJECT P
WHERE P.DNo = 5 AND NOT EXISTS (
    SELECT *
  FROM WORKS_ON W
  WHERE W.SSN = E.SSN AND W.PNo = P.PNo
  )
);
SELECT D.DNo, COUNT(*) AS NumHighEarningEmployees
FROM EMPLOYEE E
  JOIN DEPARTMENT D ON E.DNo = D.DNo
WHERE E.Salary > 600000
GROUP BY D.DNo
HAVING COUNT(*) > 5;



-- Lab Record

CREATE TABLE DEPARTMENT
(DNO VARCHAR2 (20) PRIMARY KEY,
(DNO VARCHAR2 (20) PRIMARY KEY,
MGRSTARTDATE
DNAME VARCHAR2 (20), MGRSTARTDATE
DATE);
CREATE TABLE EMPLOYEE
(SSN VARCHAR2 (20) PRIMARYKEY,
(SSN VARCHAR2 (20) PRIMARYKEY,
FNAME VARCHAR2(20),
LNAME VARCHAR2(20),
ADDRESS VARCHAR2 (20),
SEX CHAR (1), SALARY
INTEGER,
SUPERSSN REFERENCES EMPLOYEE (SSN),
SUPERSSN REFERENCES EMPLOYEE (SSN),
DNO REFERENCES DEPARTMENT (DNO));
DNO REFERENCES DEPARTMENT (DNO));

ALTER TABLE DEPARTMENT
ADD MGRSSN REFERENCES EMPLOYEE (SSN);
CREATE TABLE DLOCATION
(DLOC VARCHAR2 (20),
DNO REFERENCES DEPARTMENT (DNO),
PRIMARY KEY (DNO, DLOC));
CREATE TABLE PROJECT (PNO
INTEGER PRIMARYKEY, PNAME
VARCHAR2(20),
PLOCATION VARCHAR2 (20),
DNO REFERENCES DEPARTMENT (DNO));
CREATE TABLE WORKS_ON
(HOURS NUMBER (2),
SSN REFERENCES EMPLOYEE (SSN),
PNO REFERENCES PROJECT(PNO),
PRIMARY KEY (SSN, PNO));

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSECE01‘,‘JOHN‘,‘SCOTT‘,‘BANGALORE‘,‘M‘, 450000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSCSE01‘,‘JAMES‘,‘SMITH‘,‘BANGALORE‘,‘M‘, 500000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSCSE02‘,‘HEARN‘,‘BAKER‘,‘BANGALORE‘,‘M‘, 700000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSCSE03‘,‘EDWARD‘,‘SCOTT‘,‘MYSORE‘,‘M‘, 500000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSCSE04‘,‘PAVAN‘,‘HEGDE‘,‘MANGALORE‘,‘M‘, 650000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSCSE05‘,‘GIRISH‘,‘MALYA‘,‘MYSORE‘,‘M‘, 450000);

INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSCSE06‘,‘NEHA‘,‘SN‘,‘BANGALORE‘,‘F‘, 800000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSACC01‘,‘AHANA‘,‘K‘,‘MANGALORE‘,‘F‘, 350000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSACC02‘,‘SANTHOSH‘,‘KUMAR‘,‘MANGALORE‘,‘M‘, 300000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSISE01‘,‘VEENA‘,‘M‘,‘MYSORE‘,‘M‘, 600000);
INSERT INTO EMPLOYEE (SSN, FNAME, LNAME, ADDRESS, SEX, SALARY) VALUES
(‗RNSIT01‘,‘NAGESH‘,‘HR‘,‘BANGALORE‘,‘M‘, 500000);
INSERT INTO DEPARTMENT VALUES (‗1‘,‘ACCOUNTS‘,‘01-JAN-01‘,‘RNSACC02‘); INSERT
INTO DEPARTMENT VALUES (‗2‘,‘IT‘,‘01-AUG-16‘,‘RNSIT01‘);
INSERT INTO DEPARTMENT VALUES (‗3‘,‘ECE‘,‘01-JUN-08‘,‘RNSECE01‘); INSERT
INTO DEPARTMENT VALUES (‗4‘,‘ISE‘,‘01-AUG-15‘,‘RNSISE01‘); INSERT INTO
DEPARTMENT VALUES (‗5‘,‘CSE‘,‘01-JUN-02‘,‘RNSCSE05‘);

UPDATE EMPLOYEE SET
SUPERSSN=NULL,DNO=‘3‘
WHERESSN=‘RNSECE01‘;
UPDATE EMPLOYEE SET
SUPERSSN=‘RNSCSE02‘,DNO=‘5‘
WHERESSN=‘RNSCSE01‘;
UPDATE EMPLOYEE SET
SUPERSSN=‘RNSCSE03‘,DNO=‘5‘
WHERESSN=‘RNSCSE02‘;
UPDATE EMPLOYEE SET
SUPERSSN=‘RNSCSE04‘,DNO=‘5‘
WHERESSN=‘RNSCSE03‘;
UPDATE EMPLOYEE SET DNO=‘5‘,
SUPERSSN=‘RNSCSE05‘
WHERESSN=‘RNSCSE04‘;

UPDATE EMPLOYEE SET DNO=‘5‘,
SUPERSSN=‘RNSCSE06‘
WHERESSN=‘RNSCSE05‘;
UPDATE EMPLOYEE SET
DNO=‘5‘, SUPERSSN=NULL
WHERESSN=‘RNSCSE06‘;
UPDATE EMPLOYEE SET DNO=‘1‘,
SUPERSSN=‘RNSACC02‘
WHERESSN=‘RNSACC01‘;
UPDATE EMPLOYEE SET
DNO=‘1‘, SUPERSSN=NULL
WHERESSN=‘RNSACC02‘;
UPDATE EMPLOYEE SET
DNO=‘4‘, SUPERSSN=NULL
WHERE SSN=‘RNSISE01‘;
UPDATE EMPLOYEE SET
DNO=‘2‘, SUPERSSN=NULL
WHERE SSN=‘RNSIT01‘;
INSERT INTO DLOCATION VALUES (‘BANGALORE‘, ‗1‘);
INSERT INTO DLOCATION VALUES (‘BANGALORE‘, ‗2‘);
INSERT INTO DLOCATION VALUES (‘BANGALORE‘, ‗3‘);
INSERTINTODLOCATIONVALUES(‘MANGALORE‘,‗4‘);
INSERTINTODLOCATIONVALUES(‘MANGALORE‘,‗5‘);
INSERT INTO PROJECT VALUES (100,‘IOT‘,‘BANGALORE‘,‘5‘); INSERT
INTO PROJECT VALUES (101,‘CLOUD‘,‘BANGALORE‘,‘5‘); INSERT INTO
PROJECT VALUES (102,‘BIGDATA‘,‘BANGALORE‘,‘5‘); INSERT INTO
PROJECT VALUES (103,‘SENSORS‘,‘BANGALORE‘,‘3‘);
INSERT INTO PROJECT VALUES (104,‘BANK MANAGEMENT‘,‘BANGALORE‘,‘1‘); INSERT INTO
PROJECT VALUES (105,‘SALARYMANAGEMENT‘,‘BANGALORE‘,‘1‘); INSERT INTO PROJECT
VALUES(106,‘OPENSTACK‘,‘BANGALORE‘,‘4‘);
INSERT INTO PROJECT VALUES (107,‘SMARTCITY‘,‘BANGALORE‘,‘2‘);

INSERT INTO WORKS_ON VALUES (4, ‗RNSCSE01‘, 100);
INSERT INTO WORKS_ON VALUES (6, ‗RNSCSE01‘, 101);
INSERT INTO WORKS_ON VALUES (8, ‗RNSCSE01‘, 102);
INSERT INTO WORKS_ON VALUES (10, ‗RNSCSE02‘, 100);
INSERT INTO WORKS_ON VALUES (3, ‗RNSCSE04‘, 100);
INSERT INTO WORKS_ON VALUES (4, ‗RNSCSE05‘, 101);
INSERT INTO WORKS_ON VALUES (5, ‗RNSCSE06‘, 102);
INSERT INTO WORKS_ON VALUES (6, ‗RNSCSE03‘, 102);
INSERT INTO WORKS_ON VALUES (7, ‗RNSECE01‘, 103);
INSERT INTO WORKS_ON VALUES (5, ‗RNSACC01‘, 104);
INSERT INTO WORKS_ON VALUES (6, ‗RNSACC02‘, 105);
INSERT INTO WORKS_ON VALUES (4, ‗RNSISE01‘, 106);
INSERT INTO WORKS_ON VALUES (10, ‗RNSIT01‘, 107);


(SELECT DISTINCT P.PNO
FROM PROJECT P, DEPARTMENT D, EMPLOYEE E
WHERE E.DNO=D.DNO
AND D.MGRSSN=E.SSN
AND E.LNAME=‘SCOTT‘)
UNION
(SELECT DISTINCT P1.PNO
FROM PROJECT P1, WORKS_ON W, EMPLOYEE E1
WHERE P1.PNO=W.PNO
AND E1.SSN=W.SSN
AND E1.LNAME=‘SCOTT‘);

SELECT E.FNAME, E.LNAME, 1.1*E.SALARY AS INCR_SAL FROM
EMPLOYEE E, WORKS_ON W, PROJECT P
WHERE E.SSN=W.SSN
AND W.PNO=P.PNO
AND P.PNAME=‘IOT‘;

SELECT SUM (E.SALARY), MAX (E.SALARY), MIN (E.SALARY), AVG
(E.SALARY)
FROM EMPLOYEE E, DEPARTMENT D
WHERE E.DNO=D.DNO
AND D.DNAME=‘ACCOUNTS‘;

SELECT E.FNAME, E.LNAME
FROM EMPLOYEE E
WHERE NOT EXISTS((SELECT PNO
FROM PROJECT
WHERE DNO=‘5‘)
MINUS (SELECT PNO
FROM WORKS_ON
WHERE E.SSN=SSN));

SELECT D.DNO, COUNT (*)
FROM DEPARTMENT D, EMPLOYEE E
WHERE D.DNO=E.DNO
AND E.SALARY>600000
AND D.DNO IN (SELECT E1.DNO
FROM EMPLOYEE E1 GROUP
BY E1.DNO HAVING COUNT
(*)>5)
GROUP BY D.DNO;